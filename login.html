<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <link rel="stylesheet" href="css/login.css">

    <!-- Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=League+Spartan:wght@100..900&display=swap" rel="stylesheet">

    <title>Expense - Sign-in</title>
</head>

<body>

    <!-- main content -->
    <div class="wrapper">
        <div class="container h-100">
            <div class="d-flex justify-content-center align-items-center">
                <img class="logo" src="images/logo1.png">
            </div>
            <div class="row mt-5 d-flex justify-content-center align-items-center">
                <div class="col-sm-6">
                    <div class="introLoginMsg">
                        <p>Create an account and start your expense management with ExpenseWise. Get data driven
                            insights, visualization and take informed decision.
                        </p>
                    </div>
                    <form id="loginForm">
                        <div class="mb-3">
                            <label for="email" class="form-label">Email</label>
                            <input type="email" class="form-control" id="email" name="email" aria-describedby="emailHelp" required>
                        </div>
                        <div class="mb-3">
                            <label for="password" class="form-label">Password</label>
                            <input type="password" class="form-control" id="password" name="password" required>
                        </div>
                        <button type="submit" class="mt-3 btn btn-outline-dark">Login to Continue</button>
                    </form>
                </div>
                <div class="col-sm-6">
                    <div class="title">
                        <p class="init">Expense</p>
                        <p class="end">Wise.</p>
                    </div>
                    <div class="description">
                        <p>Lorem ipsum dolor sit amet consectetur, adipisicing elit. Amet, at consequatur odit commodi
                            omnis repudiandae tempore mollitia distinctio incidunt provident animi atque similique
                            repellat. Sint totam, similique laborum, fugiat, laudantium optio consequatur ut quas iste
                            voluptatibus velit molestias fugit voluptate necessitatibus! Nostrum ab tenetur accusantium
                            vero, perspiciatis, eaque nihil modi quae iure suscipit, molestiae accusamus assumenda
                            officiis enim ratione soluta?</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="row">
            <div class="col-sm-6">
                
            </div>
        </div>
    </div>

    <!-- Option 1: Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>

    <script>
        document.getElementById('loginForm').addEventListener('submit', async function (event) {
            event.preventDefault(); // Prevent the default form submission

            const userEmail = document.getElementById('email').value;
            const userPass = document.getElementById('password').value;

            const userDataJson = {
                "email" : userEmail,
                "password" : userPass
            }

            try {
                // Send the data to the API
                const response = await fetch('http://localhost:8080/api/users/login', {
                    method: 'POST',
                    mode: 'cors',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ data: userDataJson })
                });

                if (response.status != 400) {
                    const result = await response.json();
                    const resultJSON = JSON.stringify(result);
                    console.log("HERE IN RES OK")
                    // console.log('Data submitted successfully: ' + JSON.stringify(result));
                    // save the user data to localStorage
                    window.sessionStorage.setItem("userid", result["userid"]);
                    window.sessionStorage.setItem("accessToken", result["accessToken"]);
                    window.location.href = "http://127.0.0.1:5500/dashboard.html";
                } else {
                    console.log(response);
                    alert('Error submitting data: ' + response.statusText);
                }
            } catch (error) {
                console.log(response);
                alert('Error submitting data: ' + error.message);
            }
        });

    </script>



</body>

</html>